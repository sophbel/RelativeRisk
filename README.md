# RelativeRisk
<br />
*Match_tree_meta*: Match tree label to metadata label
Input:
Metadata: metadata file 
Collection time
Lane ID
Tree: tree file generated from Gubbins
drop_tip_name: the name of the tip to be dropped, usually the reference name
drop_tip: TRUE to drop the tip of drop_tip_name
Output: 
matched tree+metadata table
matched and ordered metadata table
dropRef_tree

warning:
check manually the tip and laneid

Time_resolved: generate estimated divergence time between isolates
Input:
match_tree_meta: metadata table generated by match_tree_meta
dropRef_tree: tree file generated from Gubbins without reference tip
save_bd_path: path to save the bactdating results
time: column name of collection time in match_tree_meta (optional)
Output:
Root2tip
Bactdating results

warning:
check the positive correlation manually

—-----

RR_matrix: generate pairwise matrices from metadata file
Input: 
meta_table (metadata file)
GPSC from PoPUNK2
Region/Location
Longitude & Latitude (for pairwise distance calculation)
Collection time (year)
bactdat_tree (tree file generated from Bactdating)
coltime_range (range of pairwise collection time difference (year), default 1 year)
divtime_range (range of pairwise divergence time difference (year), default 50 year)
distance_range (range of pairwise distance (km), default 100 km)
Output: pairwise matrices (0,1 matrices) 
pairwise lineage matrix
pairwise location matrix
pairwise distance matrix 
pairwise collection time matrix
pairwise divergence time matrix

manually check
divergence time plot histogram, collection time, distance distribution

RelativeRiskLineage: Calculate relative risk ratio
Input: 
geo_matrix
colyear_matrix
strain_matrix
metadataset
Output:
Relative Risk ratio (mean, lower_ci, upper_ci)

denominator reference

RelativeRiskDivergence: 


PltRR: generate relative risk ratio plot (for only one calculation)
Input:
rrData: relative risk generated by RelativeRisk()
RRplotTitle: title for the plot
Output:
Relative risk plot



Workflow
—----
generate match_tree_meta table
generate bactdating results, including pairwise divergence time for each GPSC
bind all the trees and combined with metadata
Generate RR matrix
calculate RR
divergence time v.s. distance
rolling divergence time v.s. relative ratio (fixed distance)
rolling distance v.s. relative ratio (fixed divergence time)


Reference: 
https://xavierdidelot.github.io/BactDating/articles/yourData.html
